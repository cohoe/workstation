---
- name: create slack repository
  yum_repository:
    name: slack
    description: Slack desktop chat client
    baseurl: https://packagecloud.io/slacktechnologies/slack/fedora/21/$basearch
    enabled: yes
    gpgcheck: no
    gpgkey: https://packagecloud.io/gpg.key
  become: yes

- name: Slack desktop application
  dnf:
    name: slack
    state: present
  become: yes

- name: autostart slack
  copy:
    src: slack-startup.desktop
    dest: "{{ user_autostart_dir }}/slack.desktop"

- name: install dark theme
  blockinfile:
    path: /usr/lib/slack/resources/app.asar.unpacked/src/static/ssb-interop.js
    block: "{{ lookup('file', '../roles/slack/files/dark.js') }}"
    marker: "// {mark} ANSIBLE MANAGED BLOCK"
  become: yes
