Mostly taken from @ryansb's workstation repo.
