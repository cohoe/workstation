---
# Figure out the package from GitHub
- name: "package | determine"
  shell: bash -c "curl -s \"https://api.github.com/repos/cohoe/launchy/releases/latest\" | jq -r '.assets[] | select(.name | startswith(\"launchy-2\")) | .browser_download_url'"
  register: launchy_package
  failed_when: '"https://github.com/cohoe/launchy/releases/download" not in "{{ launchy_package.stdout }}"'

# Grab the RPM
- name: "package | download"
  get_url: url={{ launchy_package.stdout }}
           dest=/tmp/launchy.rpm

# Install it
- name: "install"
  dnf: name=/tmp/launchy.rpm state=latest
  become: yes

# Create the config file
- name: "Install Launchy config"
  copy: dest="~/.launchy/launchy.ini"
        src="launchy.ini"

# Autostart
- name: "Autostart Launchy"
  copy: dest="{{ user_autostart_dir }}/launchy.desktop"
        src="{{ sys_shortcuts_dir }}/launchy.desktop"
