---
- name: install dependencies
  dnf:
    name:
      - python3-pexpect
      - glib2-devel
      - gobject-introspection-devel
      - cairo-devel
      - cairo-gobject-devel
      - python3-gobject
      - python3-pulsectl
    state: latest
  become: yes

- name: install script
  get_url:
    url: https://raw.githubusercontent.com/cohoe/maxime/master/maxime.py
    dest: /usr/local/bin/maxime.py
    mode: 0755
  become: yes

- name: configuration
  template:
    src: maxime.ini
    dest: '~/.config/maxime.ini'

- name: autostart
  get_url:
    url: https://raw.githubusercontent.com/cohoe/maxime/master/DesktopFiles/maxime.desktop
    dest: "{{ user_autostart_dir }}/maxime.desktop"

- name: various desktop shortcuts
  get_url:
    url: "https://raw.githubusercontent.com/cohoe/maxime/master/DesktopFiles/{{ item }}.desktop"
    dest: "~/.local/share/applications/{{ item }}.desktop"
  with_items:
    - maxime
    - maxime-headset
    - maxime-speakers
    - maxime-status
    - maxime-wireless
    - maxime-connect
    - maxime-disconnect
    - maxime-reconnect
    - maxime-resync
