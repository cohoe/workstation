---
- include: session.yml
- include: power.yml
- include: panel.yml
- include: thunar.yml
- include: terminal.yml
- include: keyboard.yml
- include: junk.yml

- name: "explorer shortcut | create"
  copy: dest={{ local_shortcuts_dir }}/explorer.desktop
        src=explorer.desktop
  sudo: yes

- name: "menus directory | create"
  file: path=~/.config/menus
        state=directory

- name: "menus config | create"
  copy: src=xfce-applications.menu
        dest=~/.config/menus/xfce-applications.menu

- name: "autostart directory | create"
  file: path=~/.config/autostart
        state=directory

- name: "xfwm4 | set"
  shell: xfconf-query -c xfwm4 -p {{ item.key }} -s {{ item.value }}
  environment:
    DISPLAY: "{{xfce_display}}"
  with_items:
    - { key: "/general/workspace_count", value: "{{ xfce_workspace_count }}" }
    - { key: "/general/use_compositing", value: 'true' }
    - { key: "/general/show_dock_shadow", value: 'false' }
    - { key: "/general/snap_to_windows", value: 'true' }
    - { key: "/general/theme", value: "{{ xfce_theme }}" }

- name: "xsettings | font | set"
  shell: xfconf-query -c xsettings -p /Gtk/FontName -t string -s "Sans 10"
  environment:
    DISPLAY: "{{xfce_display}}"

- name: "login wallpaper | get"
  get_url: url={{ login_background }}
           dest=/usr/share/backgrounds/images/login.jpg
  sudo: yes

- name: "login wallpaper | set"
  lineinfile:
    dest: '/etc/lightdm/lightdm-gtk-greeter.conf'
    regexp: "^background="
    #line: "background=#396da6"
    line: "background=/usr/share/backgrounds/images/login.jpg"
  sudo: yes

- name: "user wallpaper | get"
  get_url: url={{ user_background }}
           dest=/usr/share/backgrounds/images/user-wallpaper.jpg
  sudo: yes

- name: "xfce4-desktop | set"
  shell: xfconf-query -c xfce4-desktop -p {{ item.key }} --create -t {{ item.type }} -s {{ item.value }}
  environment:
    DISPLAY: "{{xfce_display}}"
  with_items:
    - { key: "/desktop-icons/icon-size", type: "int", value: "32" }
    - { key: "/desktop-icons/file-icons/show-filesystem", type: "bool", value: "false" }
    - { key: "/desktop-icons/file-icons/show-home", type: "bool", value: "false" }
    - { key: "/desktop-icons/file-icons/show-trash", type: "bool", value: "false" }
    - { key: "/backdrop/screen0/monitor0/workspace0/last-image", type: "string", value: "/usr/share/backgrounds/images/user-wallpaper.jpg" }

- name: "reset"
  shell: dbus-send --print-reply --dest=org.xfce.Panel /org/xfce/Panel org.xfce.Panel.Terminate boolean:true
  environment:
    DISPLAY: "{{xfce_display}}"
