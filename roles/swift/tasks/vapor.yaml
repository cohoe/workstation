---
- name: clone repo
  git:
    repo: 'https://github.com/vapor/toolbox.git'
    dest: /opt/vapor
    version: "18.3.3"
  become: yes

- name: build
  shell:
    cmd: swift build
    chdir: /opt/vapor
  become: yes
  changed_when: false

- name: install binary
  copy:
    src: /opt/vapor/.build/debug/vapor
    dest: /usr/local/bin/vapor
    remote_src: yes
  become: yes
